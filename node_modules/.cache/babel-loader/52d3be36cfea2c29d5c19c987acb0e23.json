{"ast":null,"code":"import CryptoJS from 'crypto-js';\nconst sendToServerForSecondEncryption = {\n  encryptFirstCipherText: (firstCipherText, sender, medicalReportId) => {\n    let hash = CryptoJS.SHA256(firstCipherText).toString(CryptoJS.enc.Hex);\n    let secondCipherText = CryptoJS.AES.encrypt(firstCipherText, hash).toString();\n    localStorage.setItem(sender + medicalReportId, hash);\n    return secondCipherText;\n  },\n  decryptSecondCipherText: (secondCipherText, sender, medicalReportId) => {\n    let hash = localStorage.getItem(sender + medicalReportId);\n    let firstCipherText = CryptoJS.AES.decrypt(secondCipherText, hash).toString(CryptoJS.enc.Utf8);\n    return firstCipherText;\n  }\n};\nexport default sendToServerForSecondEncryption;","map":{"version":3,"names":["CryptoJS","sendToServerForSecondEncryption","encryptFirstCipherText","firstCipherText","sender","medicalReportId","hash","SHA256","toString","enc","Hex","secondCipherText","AES","encrypt","localStorage","setItem","decryptSecondCipherText","getItem","decrypt","Utf8"],"sources":["/Users/boweima/Desktop/blockchain/src/server/sendToServerForSecondEncryption.js"],"sourcesContent":["import CryptoJS from 'crypto-js'\n\nconst sendToServerForSecondEncryption = {\n    encryptFirstCipherText: (firstCipherText, sender, medicalReportId) => {\n        let hash = CryptoJS.SHA256(firstCipherText).toString(CryptoJS.enc.Hex)\n        let secondCipherText = CryptoJS.AES.encrypt(firstCipherText, hash).toString();\n        localStorage.setItem(sender+medicalReportId, hash)\n        return secondCipherText\n    },\n    decryptSecondCipherText: (secondCipherText, sender, medicalReportId) => {\n        let hash = localStorage.getItem(sender + medicalReportId)\n        let firstCipherText = CryptoJS.AES.decrypt(secondCipherText, hash).toString(CryptoJS.enc.Utf8);\n        return firstCipherText\n    }\n}\n\nexport default sendToServerForSecondEncryption\n\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAEhC,MAAMC,+BAA+B,GAAG;EACpCC,sBAAsB,EAAEA,CAACC,eAAe,EAAEC,MAAM,EAAEC,eAAe,KAAK;IAClE,IAAIC,IAAI,GAAGN,QAAQ,CAACO,MAAM,CAACJ,eAAe,CAAC,CAACK,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACC,GAAG,CAAC;IACtE,IAAIC,gBAAgB,GAAGX,QAAQ,CAACY,GAAG,CAACC,OAAO,CAACV,eAAe,EAAEG,IAAI,CAAC,CAACE,QAAQ,EAAE;IAC7EM,YAAY,CAACC,OAAO,CAACX,MAAM,GAACC,eAAe,EAAEC,IAAI,CAAC;IAClD,OAAOK,gBAAgB;EAC3B,CAAC;EACDK,uBAAuB,EAAEA,CAACL,gBAAgB,EAAEP,MAAM,EAAEC,eAAe,KAAK;IACpE,IAAIC,IAAI,GAAGQ,YAAY,CAACG,OAAO,CAACb,MAAM,GAAGC,eAAe,CAAC;IACzD,IAAIF,eAAe,GAAGH,QAAQ,CAACY,GAAG,CAACM,OAAO,CAACP,gBAAgB,EAAEL,IAAI,CAAC,CAACE,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACU,IAAI,CAAC;IAC9F,OAAOhB,eAAe;EAC1B;AACJ,CAAC;AAED,eAAeF,+BAA+B"},"metadata":{},"sourceType":"module"}